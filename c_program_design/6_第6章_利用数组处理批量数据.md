[TOC]

# 第6章 利用数组处理批量数据

> - 注：
>   - 数组是一组==有序==数据的集合；
>   - 用一个==数组名==和==下标==来唯一地确定数组中的元素；
>     - 方括号中的数字用来表示下标。
>   - 数组中的每一个元素都属于==同一个数据类型==；
>   - 将数组与循环结合起来，可以有效地处理大批量的数据。
>   - 一个数组中包含多个相同类型的数组元素，这些数组元素可以是基本数据类型或构造类型。因此，按数组元素的类型不同，数组又可分为数值数组、字符数组、指针数组、结构数组等各种类别。

---
## 6.1 怎样定义和引用一维数组

> - 注：要使用数组，必须在程序中先定义数组，即通知计算机
>   - 数组由那些数据组成；
>   - 数组中有多少元素；
>   - 数据元素属于哪个数据类型。

### 6.1.1 怎样定义一维数组

- 一般形式
  - 类型符 数组名[常量表达式]；
- 注意：
  - 需要制定数组中元素的个数
    - 常量表达式中，可以使用常量或符号产量，不能包含变量；
    - > C 语言不允许对数组的大小作动态定义。
  - ==如果在被调用的函数（不包括主函数）中定义数组，其长度可以是变量或非常量表达式==，如下所示
    ```C
    void func(int n)
    {
        int a[2 * n];  // 这样是合法的，n 的值从实参传来
    }
    ```
    - > 可以这样做的原因在于 C 编译器可以根据函数的实参在初始化栈空间时为数组分配栈内存。这种情况被称为“==可变长数组==”。在执行函数时，n 的值是不变的。
  - 如果指定数组为静态(static)存储方式，则不能用“可变长数组”
    - 原因在于采用静态存储方式时，数据被存储在静态存储区（而不是栈内存）。

### 6.1.2 怎样引用一维数组元素

- 一般形式
  - 数组名[下标]
- > 注：只能引用数组元素，而不能一次整体调用整个数组中全部元素的值。

- [例6.1](./examples/6.1.c)

### 6.1.3 一维数组的初始化

- 数组的初始化：为了使程序简洁，常在定义数组的同时，给各数组元素赋值，操作方法如下：
  - 在定义数组时对全部数组元素赋予初值
    - int a[5] = {0, 1, 2, 3, 4};
  - 可以只给数组中的一部分元素赋值
    - int a[5] = {0, 1};
    - 表示只给前面2个元素赋值，系统自动给后面3个元素赋予初值 0。
    > - ==如果是字符型数组，则初始化为 '\0'==; 
    > - ==如果是指针型数组，则初始化为 NULL==。
  - 如果想使一个数组中全部元素的值为 0，有两种写法
    - int a[5] = {0， 0， 0， 0， 0}；
    - int a[5] = {0};
  - 在对全部数组元素赋予初值时，由于数据的个数已经确定，因此可以不指定数组长度（编译器会自己数）
    - int a[] = {0, 1, 2, 3, 4};
    - > 如果数组长度与提供初值的个数不同，则方括号中的数组长度不能省略。

### 6.1.4 一维数组程序举例

- [例6.2](./examples/6.2.c)

---
## 6.2 怎样定义和引用二维数组

### 6.2.1 怎样定义二维数组

- 一般形式
  - 类型说明符 数组名[常量表达式][常量表达式];
- 说明
  - C 语言中，二维数组中元素排列的顺序是==按行存放==的，即在内存中==先顺序存放第1行的元素==，接着再存放第2行的元素。
  - 在内存中，各元素是连续存放的，是线性的，而不是二维的。
  - > 类比二维数组的定义，可以得到多维数组的定义。

### 6.2.2 怎样引用二维数组的元素

- 一般形式
  - 数组名[下标][下标]
- 说明
  - 引用数组元素时，下标值应在已定义的数组大小的范围内；
- 注意：严格区分在定义数组时使用的 a[3][4] 和引用元素时的 a[3][4]的区别。

### 6.2.3 二维数组的初始化

- 分行给二维数组赋初值
  - int a[2][3] = {{1, 2, 3}, {4, 5, 6}};
- 把所有数据写在一个花括号内（这样做不好，因为不够清晰）
  - int a[2][3] = {1, 2, 3, 4, 5, 6};
- 只对部分元素赋初值（其余元素由编译器自动填 0）
  - 只对第一列的元素赋初值。
    - int a[2][3] = {{1}, {4}};
  - 只对各行中的某一元素赋初值
    - int a[2][3] = {{1}, {0, 5}};
  - 只对某几行元素赋初值
    - int a[2][3] = {{}, {0, 0, 6}};
- 如果对全部元素都赋初值，则定义数组时对==第1维==的长度可以不指定，但第2维的长度不能省
  - a [][3] = {1, 2, 3, 4, 5, 6};
- 也可以只对==部分元素赋初值==，并且省略第1维的长度，但应==分行赋初值==（这样编译器就知道实际包含几行了）
  - a [][3] = {{}, {0, 5}};

### 6.2.4 二维数组程序举例

- [例6.4](./examples/6.4.c)

---
## 6.3 字符数组

> 在 C 99 标准中，把字符类型归纳为整型类型中的一种。

### 6.3.1 怎样定义字符数组

- 定义方法：与定义数值型数组的方法类似
  - 例：
  ```C
  char c[3];
  c[0] = 'I'; c[1] = ' '; c[2] = 'a';
  ```
- >  字符型数据是以整数形式（ASCII 码）存放的，因此也可以用整型数组存放字符型数据（就是浪费内存空间）
  - 例：
  ```C
  int c[3];
  c[0] = 'I'; c[1] = ' '; c[2] = 'a';
  ```

### 6.3.2 字符数组的初始化

- 字符数组的初始化方式
  - 初始化列表，例如：
    - char c[3] = {'I', ' ', 'a'};
> 注：
> - 如果在定义字符数组时不进行初始化，则数组中各元素的值时不可预料的;
> - 如果花括号中提供的初值个数大于数组长度，则出现语法错误；
> - 如果花括号中提供的初值个数小于数组长度，则先用花括号中的字符逐一为数组前面的元素赋值，其余元素自动定为空字符（即'\0'）；
> - 如果提供的初值个数与预定的数组==长度相同==，在定义时可以省略数组长度；
> - 定义和初始化二维字符数组的方式同上。

### 6.3.3 怎样引用字符数组中的元素

- [例6.6](./examples/6.6.c)
> 注：引用字符数组中的元素的方式同普通数组。

### 6.3.4 字符串和字符串结束标志

> C 语言中没有字符串类型，字符串是存放在字符型数组中的（将字符串作为字符数组来处理）。

- C 语言规定以字符 '\0' 作为“字符串结束标志”
  - C 系统在用字符数组存储用双引号表示的字符串常量时（例如 "C program"）,会在末尾自动添加该结束标志，例如；
    - char c[] = {"I am happy"};
    - char c[] = "I am happy";
    - > 以上两种方式等价。
  - 在程序中往往通过该标志判定字符串是否结束（而不是字符数组的长度）。

> 注：
>  - 字符数组并不要求它的最后一个字符为 '\0'
>  - 是否需要加 '\0' 完全根据需要决定；
>  - 系统在处理==字符串常量的存储==时会自动加一个 '\0'，为了使处理方法一致，便于测定字符串的实际长度，在==字符数组==中也常常人为地加上一个 '\0'（这样可以便于引用字符数组中的字符串）。

### 6.3.5 字符数组的输入输出

- ==逐个字符==输出：用格式符 “%c”，例如
  ```C
  char c[] = "China";
  for (int i = 0; i < 5; i++) printf("%c", c[i]);
  ```
- 作为==字符串==整个输出：用格式符 “%s”，例如
  ```C
  char c[] = "China";
  printf("%s", c);
  ```
  - 注： 
    - 输出时，遇到结束符 '\0' 就自动停止（即使数组长度大于字符串的实际长度）；
      - 如果字符数组中包含多个 '\0'，遇到第一个时就停止。
    - 输出的字符中==不包括结束符== '\0'；
    - printf 函数中的输出项是字符数组名，而不是元素名（有下标）。

- 用 scanf 函数输入一个字符串，例如
  ```C
  char c[10];
  scanf("%s", c);
  ```
  - 注：
    - 输入的字符串应==短于==已定义的字符数组的长度；
    - 系统会自动在输入的字符串后面添加结束符 '\0'；
    - 字符数组末尾未被赋值的元素回被自动置 '\0'。
- 用 scanf 函数输入多个字符串，例如
  ```C
  char c1[10], c2[10], c3[10];
  scanf("%s%s%s", c1, c2, c3)
  ```
  - 注：
    - 如果要==一次性输入多个字符串==，则在输入时默认以==空格==分隔各个字符串；
    - 每个字符串后面都会被系统自动添加结束符 '\0'。
- > scanf 输入字符数组时，不用再加地址符 “&”。

### 6.3.6 使用字符串处理函数

> 几乎所有版本的 C 编译系统都提供以下几种常用的函数。
> 在使用字符串处理函数时，要==引用头文件 <string.h>==

- puts()
  - 作用：输出字符串（以 '\0' 结束的字符序列）到终端
  - 一般形式：puts(字符数组);
  - 例如：puts(str);  // char str[10] = "China";
  - 注：由于 printf 函数可以实现同样的功能，因此 puts 函数用得不多。
- gets()
  - 作用：输入一个字符串到字符数组，并返回字符数组的起始地址
  - 一般形式：gets(字符数组);
  - 例如：gets(str);  // char str[10];
  - 注：
    - 一般利用 gets 函数的目的是想字符数组输入一个字符串，而不大关心其函数值；
    - 读入的字符串中可以包含空格。
- strcat()
  - 作用：连接连个字符串1和字符串2 -- 把字符串2连接到字符串1的后面，结果存放在字符数组1中，并返回字符数组1的地址
  - 一般形式：strcat(字符数组1，字符数组2);
  - 例如：strcat(str1, str2);  // char str1[20] = "Hello", str2[10] = "world";
  - 注：
    - 字符数组1必须足够大，以便能够容纳连接后的新字符串；
    - 连接前两个字符串后面都有'\0'，连接时将字符串1后面的'\0'取消，只在新串最后保留'\0'。
- strcpy()
  - 作用：将字符串2赋值到字符数组1中
  - 一般形式：strcpy(字符数组1， 字符串2);
  - 例如: strcpy(str1, str2);  // char str1[10], str2[] = "hello";
  - 注：
    - 字符数组1必须定义得足够大；
      - 如果在复制前未对 str1 数组初始化或赋值，那么复制后把 str2 中的内容（包括一个 '\0'）放在str1 的前面，而 str1 的剩余部分的内容是无法预知的。
    - “字符数组1”必须写成数组名形式，“字符串2”可以是字符数组名，也可以是一个字符串常量；
    - ==不能用赋值语句==将一个字符串常量或字符数组直接给一个字符数组，例如
      ```C
      str1 = "China";  // 不合法
      str1 = str2;     // 不合法
      ```
- strncpy()
  - 作用：将字符串2中前面 n 个字符复制到字符数组1中
  - 一般形式：strncpy(str1, str2, n);
  - 注：n 的数值不应多于 str1 的大小。
- strcmp()
  - 作用：比较字符串1和字符串2的大小
  - 一般形式：strcmp(str1, str2);
  - 注：
    - 比较规则是：将两个字符串自左至右逐个字符相比（按 ASCII 码值大小比较），直到出现不同的字符或遇到 '\0' 为止；
      - 如果字符串1=字符串2，则函数返回值为0；
      - 如果字符串1>字符串2，则函数返回值为一个正整数；
      - 如果字符串1<字符串2，则函数返回值为一个负整数。
    - 如全部字符相同，则认为两个字符串相等；
    - 如出现不相同的字符，则以==第一对==不相同的字符的比较结果为准。
- strlen()
  - 作用：测试字符串的长度（不包括'\0'）
  - 一般形式：strlen(str);  // char str[] = "hello";
  - 注：可以直接测试字符串常量的长度。
- strlwr()
  - 作用：将字符串中的大写字母转换为小写字母
  - 一般形式：strlwr(字符串);
- strupr()
  - 作用：将字符串中的小写字母转换为大写字母
  - 一般形式：strupr(字符串);

### 6.3.7 字符数组应用举例

- [例6.8](./examples/6.8.c)
